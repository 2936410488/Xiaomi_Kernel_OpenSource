LPM_MODULES_FOLDER=$(srctree)/drivers/misc/mediatek/lpm/modules/

ccflags-y += -I$(LPM_MODULES_FOLDER)/include/

#Get platform name
MTK_LPM_MODULE_PLATFORM_PLAT_NAME = $(strip $(subst ",, $(CONFIG_MTK_LPM_MODULE_NAME)))

ifneq ($(or $(findstring mt6853, $(MTK_LPM_MODULE_PLATFORM_PLAT_NAME)),\
	$(findstring mt6873, $(MTK_LPM_MODULE_PLATFORM_PLAT_NAME))),)
MTK_LPM_PLATFORM_VERSION = v1
MTK_LPM_SUSPEND_VERSION = suspend_v1
endif

#mtk-lpm platform source files
ifneq ($(MTK_LPM_MODULE_PLATFORM_PLAT_NAME), )
include $(LPM_MODULES_FOLDER)/platform/$(MTK_LPM_PLATFORM_VERSION)/Makefile
include $(LPM_MODULES_FOLDER)/platform/$(MTK_LPM_SUSPEND_VERSION)/Makefile


ccflags-y += -I$(LPM_MODULES_FOLDER)/platform/$(MTK_LPM_PLATFORM_VERSION)/
ccflags-y += -I$(LPM_MODULES_FOLDER)/platform/$(MTK_LPM_SUSPEND_VERSION)/


ccflags-y += ${LPM_MODULE_PLAT_PLATFORM_CFLAGS}
LPM_MODULE_PLAT_PLATFORM = $(LPM_MODULE_PLAT_PLATFORM_OBJS:%.o=$(MTK_LPM_PLATFORM_VERSION)/%.o)
LPM_MODULE_PLAT_PLATFORM += $(LPM_MODULE_PLAT_PLATFORM_SUSPEND_OBJS:%.o=$(MTK_LPM_SUSPEND_VERSION)/%.o)

#Generic build
BUILD_MTK_LPM_PLAT_MODUDLE_NAME=mtk-lpm-plat-${MTK_LPM_MODULE_PLATFORM_PLAT_NAME}
obj-$(CONFIG_MTK_LOW_POWER_MODULE) += ${BUILD_MTK_LPM_PLAT_MODUDLE_NAME}.o

${BUILD_MTK_LPM_PLAT_MODUDLE_NAME}-objs += $(LPM_MODULE_PLAT_PLATFORM)
endif
